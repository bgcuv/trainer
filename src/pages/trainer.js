import { useState, useEffect, useRef } from "react";
import { Center, Flex, Heading, Box } from "@chakra-ui/react";
import Head from "next/head";
import Nav from "@/components/Nav";

// moves: Forward Smash, Down Special,
// Forward Air
// arrows
// →⇉
const moves = [
  {
    buttons: "⇉ A",
    name: "Forward Smash",
  },
  {
    buttons: "⇉ B",
    name: "Side Special",
  },
  {
    buttons: "ZR or ZL",
    name: "Shield",
  },
  {
    buttons: "⇈ →",
    name: "Forward Air",
  },
  {
    buttons: "→",
    name: "Forward Tilt",
  },
];

const random = (min, max) => Math.floor(Math.random() * (max - min)) + min;

function useInterval(callback, delay) {
  const savedCallback = useRef();

  // Remember the latest callback.
  useEffect(() => {
    savedCallback.current = callback;
  }, [callback]);

  // Set up the interval.
  useEffect(() => {
    function tick() {
      savedCallback.current();
    }
    if (delay !== null) {
      let id = setInterval(tick, delay);
      return () => clearInterval(id);
    }
  }, [delay]);
}

export default function Home() {
  const [moveIndex, setMoveIndex] = useState(0);

  useInterval(() => {
    setMoveIndex(random(0, moves.length));
  }, 2000);

  return (
    <>
      <Head>
        <title>Trainer</title>
        <meta name="description" content="Generated by create next app" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <Flex
        direction="column"
        gap={8}
        p={4}
        color="whiteAlpha.900"
        as="main"
        height="100%"
        bgGradient="linear(#191970, #9967A4, #C46E9D, #F48D86, #FEBC64, #FFDD5A)"
      >
        <Center>
          <Heading>Trainer</Heading>
        </Center>
        <Flex direction="column" justify="center">
          <Box>{moves[moveIndex].buttons}</Box>
          <Box>{moves[moveIndex].name}</Box>
        </Flex>
      </Flex>
      <Nav left="tier-list" right="about" />
    </>
  );
}
